{% extends "base.html" %}

{% block body%}
{% load static %}


    <script type="text/javascript">

    $(function() {

        var datasets = { {% for d in d1 %}
            "{{ d.0.cod_area }}": {
                label: "{{ d.0.area }}",
                data: [{% for x in d %} [{{ x.ano }}, {{ x.cpc_continuo }}], {% endfor %}]
            },
            {% endfor %}
        };

        // hard-code color indices to prevent them from shifting as
        // countries are turned on/off

        var i = 0;
        $.each(datasets, function(key, val) {
            val.color = i;
            ++i;
        });

        // insert checkboxes
        var choiceContainer = $("#choices");
        $.each(datasets, function(key, val) {
            choiceContainer.append("<br/><input type='checkbox' name='" + key +
                "' checked='checked' id='id" + key + "'></input>" +
                "<label for='id" + key + "'>"
                + val.label + "</label>");
        });

        choiceContainer.find("input").click(plotAccordingToChoices);

        function plotAccordingToChoices() {

            var data = [];

            choiceContainer.find("input:checked").each(function () {
                var key = $(this).attr("name");
                if (key && datasets[key]) {
                    data.push(datasets[key]);
                }
            });

            if (data.length > 0) {
                $.plot("#placeholder", data, {
                    yaxis: {
                        min: 0
                    },
                    xaxis: {
                        tickDecimals: 0
                    }
                });
            }
        }

        plotAccordingToChoices();

    });

    </script>

<p id="choices" style="float:right; width:135px;"></p>
<div id="placeholder" style="width:700px;height:300px;"></div>

{% endblock %}